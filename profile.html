<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>User Profile - ADORA</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap');

* {
margin: 0;
padding: 0;
box-sizing: border-box;
font-family: 'Poppins', sans-serif;
}

body {
background: linear-gradient(45deg, #E5D9F2, #F5EFFF);
min-height: 100vh;
}

.profile-container {
max-width: 1000px;
margin: 50px auto;
padding: 20px;
background: rgba(255, 255, 255, 0.9);
border-radius: 15px;
box-shadow: 0 8px 20px rgba(0,0,0,0.1);
}

.profile-header {
display: flex;
align-items: center;
gap: 20px;
padding: 20px;
border-bottom: 2px solid #eee;
}

.profile-pic {
width: 100px;
height: 100px;
border-radius: 50%;
background: #5a36a8;
display: flex;
align-items: center;
justify-content: center;
color: white;
font-size: 40px;
}

.profile-info h1 {
color: #333;
margin-bottom: 5px;
}

.profile-info p {
color: #666;
}

.profile-content {
display: grid;
grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
gap: 20px;
padding: 20px;
}

.profile-section {
background: white;
padding: 20px;
border-radius: 10px;
box-shadow: 0 4px 6px rgba(0,0,0,0.05);
}

.profile-section h2 {
color: #5a36a8;
margin-bottom: 15px;
}

.stat-grid {
display: grid;
grid-template-columns: repeat(2, 1fr);
gap: 15px;
}

.stat-item {
padding: 15px;
background: #f8f9fa;
border-radius: 8px;
text-align: center;
}

.stat-item h3 {
color: #5a36a8;
font-size: 24px;
margin-bottom: 5px;
}

.stat-item p {
color: #666;
font-size: 14px;
}

.action-buttons {
display: flex;
gap: 10px;
margin-top: 20px;
}

.btn {
padding: 10px 20px;
border: none;
border-radius: 5px;
cursor: pointer;
font-weight: 500;
transition: all 0.3s ease;
}

.btn-primary {
background: #5a36a8;
color: white;
}

.btn-secondary {
background: #f8f9fa;
color: #333;
}

.btn:hover {
transform: translateY(-2px);
box-shadow: 0 4px 8px rgba(0,0,0,0.1);
}

.logout-btn {
background: #ff416c;
color: white;
}
</style>
  <script src="auth.js"></script>
</head>
<body>
<div class="profile-container">
<div class="profile-header">
<div class="profile-pic" id="profileInitial"></div>
<div class="profile-info">
<h1 id="userName">Loading...</h1>
<p id="userEmail">Loading...</p>
</div>
</div>

<div class="profile-content">
<div class="profile-section">
<h2>Account Overview</h2>
<div class="stat-grid">
<div class="stat-item">
<h3 id="orderCount">0</h3>
<p>Orders</p>
</div>
<div class="stat-item">
<h3 id="cartCount">0</h3>
<p>Cart Items</p>
</div>
</div>
<div class="action-buttons">
<button class="btn btn-primary" onclick="window.location.href='cart.html'">View Cart</button>
<button class="btn btn-secondary" onclick="window.location.href='index.html'">Continue Shopping</button>
</div>
</div>

<div class="profile-section">
<h2>Quick Actions</h2>
<div class="action-buttons">
<button class="btn btn-primary" onclick="window.location.href='address.html'">Manage Addresses</button>
<button class="btn logout-btn" onclick="logout()">Logout</button>
</div>
</div>
</div>
</div>
 
<script>
async function loadProfile() {
    if (!Auth.isAuthenticated()) {
        window.location.href = 'login.html';
        return;
    }

    try {
        const response = await fetch('https://adora-t8e8.onrender.com/api/user/profile', {
            headers: {
                'Auth': Auth.getToken()
            }
        });
        const data = await response.json();

        if (!data.user) {
            throw new Error('User not found');
        }

        // Update UI with user data
        document.getElementById('userName').textContent = data.user.name;
        document.getElementById('userEmail').textContent = data.user.email;
        document.getElementById('profileInitial').textContent = data.user.name[0].toUpperCase();

        // Fetch cart count
        const cartResponse = await fetch('https://adora-t8e8.onrender.com/api/cart/user', {
            headers: {
                'Auth': Auth.getToken()
            }
        });
        const cartData = await cartResponse.json();
        document.getElementById('cartCount').textContent = cartData.length || 0;

    } catch (error) {
        console.error('Error:', error);
        Auth.logout();
    }
}

// Load profile on page load
window.addEventListener('DOMContentLoaded', loadProfile);

// Update logout function
function logout() {
    Auth.logout();
}
</script></body>
</html>
